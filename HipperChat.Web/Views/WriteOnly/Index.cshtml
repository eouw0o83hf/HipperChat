@model HipperChat.Web.Models.WriteOnly.MessageModel
@{
    Layout = "~/Views/Shared/_Global.cshtml";
}

@section Scripts {    
    <script type="text/javascript">
        $(".room-checkbox").on("change", function () {
            $(".room-checkbox").not($(this)).attr("checked", false);
        });

        var colors = Array("yellow", "red", "green", "purple", "gray");
        $("#such-color").on("click", function () {
            suchColor();
        });
        function suchColor() {
            $("#Color").val(colors[Math.floor(Math.random() * colors.length)]);
        }
        suchColor();

        $("form").unbind();
        $("form").submit(function () {

            $.post($(this).attr("action"), $("form").serialize())

            suchColor();
            $("#Message").val("");
            return false;
        });
    </script>
}

@using (Html.BeginForm())
{
    @Html.HiddenFor(a => a.ApiKey)
        
    <table>
        <tbody>
            <tr>
                <td>Such Message
                </td>
                <td>
                    @Html.TextAreaFor(a => a.Message)
                </td>
            </tr>
            <tr>
                <td>Wow
                </td>
                <td>
                    @Html.TextBoxFor(a => a.Color) <button type="button" id="such-color">such color</button>
                </td>
            </tr>
            <tr>
                <td>@Html.LabelFor(a => a.IsHtml, "Very marked up?")
                </td>
                <td>
                    @Html.CheckBoxFor(a => a.IsHtml)
                </td>
            </tr>
            <tr>
                <td>@Html.LabelFor(a => a.SuchAnnoy, "So notify?")
                </td>
                <td>
                    @Html.CheckBoxFor(a => a.SuchAnnoy)
                </td>
            </tr>
            <tr>
                <td>wut room?
                </td>
                <td>
                    <ul>
                        @for (var i = 0; i < Model.Rooms.Count; ++i)
                        {
                            <li>
                                @Html.Hidden("Rooms.Index", i)
                                @Html.HiddenFor(a => a.Rooms[i].Id)
                                @Html.CheckBoxFor(a => a.Rooms[i].IsSelected, new { @class = "room-checkbox" })
                                @Html.LabelFor(a => a.Rooms[i].IsSelected, Model.Rooms[i].Name)
                            </li>
                        }
                    </ul>
                </td>
            </tr>
        </tbody>
    </table>
        
    <button type="submit">Hit it</button>
}